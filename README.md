Создание виртуальной машины с помощью Vagrant, в которой через Ansible provision устанавливается Docker, node-exporter, запускается docker-compose с Prometheus и Grafana.
После выполнения команды vagrant up в браузере хостовой машины по адресу http://localhost:3000 открывается Grafana с Node Exporter Full. Имя и пароль для входа в веб-интерфейс графаны: admin/admin.

Для запуска использовать команду: 
git clone git@github.com:angurianov/Vagrant.git && \
cd Vagrant && \
vagrant up

## Vagrant
Так как в условиях задачи нет требований к используемому провайдеру vagrant и выделяемым системным ресурсам (RAM, CPU), то этот блок конфигурации отсутствует в решении.
Так как требуется входить на страницу с графаной через адрес localhost, то между хостовой ОС и виртуальной машиной vagrant требуется только проброс портов (NAT, настройка по-умолчанию).

## Ansible
Для использования Ansible provision требуется установленный на хостовую машину Ansible. Так как в условиях задачи не указано, есть ли ansible на хостовой ОС, то лучше использовать Ansible Local Provisioner, устанавливаемый внутрь виртуальной машины.

## Docker
Для запуска docker-compose нужен установленный на ВМ docker. Установить его можно или с помощью Ansible, или с помощью 

## Node-exporter

## Docker



Использование localhost вместо inventory_path

В docker-compose используем образы тех паблишеров с докерхаба, которые указаны в официальной документации к графане (grafana/grafana-oss) и прометеусу (prom/prometheus). В качестве версии (тэга) не рекомендуется использовать latest, во избежания проблем и различий в версиях при запуске контейнеров (пуле образов) в разные даты. В условии задачи нет условий по используемым версиям, поэтому используются последние. Аналогично с node-exporter.

Для того, чтобы node exporter мог собирать все метрики хоста, его следует устанавливать на хостовую машину, а не контейнером через docker-compose.

Docker внутрь виртуальной машины можно установить несколькими способами. Самым простым при использовании vagrant является установка с помощью провижионинга докера без дополнительных инструкций.

Для установки node exporter нужно использовать релиз для корректной архитектуры (amd64 / arm64 / 386). Для этого выбираем в плейбуке??

Чтобы node-exporter запустился в фоне, лучше всего запустить его как systemd unit file. Для этого предварительно подготовлен данный файл, который с помощью ansible playbook копируется в /etc/systemd/systemd. Файл node_exporter из архива копируется в /usr/local/bin.

Для того, чтобы контейнерный prometheus собирал данные с хостового node-exporter, нужно прописать это в targets в /etc/prometheus/prometheus.yml, указав адрес шлюза для докер сети, в которой находится контейнер, и порт 9100. 
